{{ if not (.Page.Scratch.Get "katex") }}
<!-- Include katex only first time -->
<link rel="stylesheet" href="{{ "katex/katex.min.css" | relURL }}">
<script defer src="{{ "katex/katex.min.js" | relURL }}"></script>
<script defer src="{{ "katex/contrib/auto-render.min.js" | relURL }}" onload="renderMathInElement(document.body);"></script>
{{ .Page.Scratch.Set "katex" true }}
{{ end }}

<span class="katex {{ with .Get "class" }}{{ . }}{{ end }}">
  {{ if in .Params "block" }}\[{{ else }}\({{ end -}}
  {{ $.Inner }}
  {{- if in .Params "block" }}\]{{ else }}\){{ end }}
</span>
